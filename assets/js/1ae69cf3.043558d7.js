/*! For license information please see 1ae69cf3.043558d7.js.LICENSE.txt */
"use strict";(self.webpackChunkbackstage_microsite=self.webpackChunkbackstage_microsite||[]).push([[790209],{132649:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>s,toc:()=>r});var t=a(474848),o=a(28453);const c={id:"collators",title:"Collators",description:"Indexing you Backstage content with Collators"},l=void 0,s={id:"features/search/collators",title:"Collators",description:"Indexing you Backstage content with Collators",source:"@site/../docs/features/search/collators.md",sourceDirName:"features/search",slug:"/features/search/collators",permalink:"/docs/next/features/search/collators",draft:!1,unlisted:!1,editUrl:"https://github.com/backstage/backstage/edit/master/docs/features/search/collators.md",tags:[],version:"current",frontMatter:{id:"collators",title:"Collators",description:"Indexing you Backstage content with Collators"},sidebar:"docs",previous:{title:"Search Engines",permalink:"/docs/next/features/search/search-engines"},next:{title:"How-To guides",permalink:"/docs/next/features/search/how-to-guides"}},i={},r=[{value:"Catalog",id:"catalog",level:2},{value:"Configuring the Catalog Collator",id:"configuring-the-catalog-collator",level:3},{value:"Scheduling",id:"scheduling",level:4},{value:"Filtering",id:"filtering",level:4},{value:"TechDocs",id:"techdocs",level:2},{value:"Configuring the TechDocs Collator",id:"configuring-the-techdocs-collator",level:3},{value:"Community Collators",id:"community-collators",level:2},{value:"Custom Collators",id:"custom-collators",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:["Backstage includes 2 ",(0,t.jsx)(n.a,{href:"/docs/next/features/search/concepts#collators",children:"collators"})," out of the box for the ",(0,t.jsx)(n.a,{href:"#catalog",children:"Catalog"})," and ",(0,t.jsx)(n.a,{href:"#techdocs",children:"TechDocs"}),". There's also some from the ",(0,t.jsx)(n.a,{href:"#community-collators",children:"Backstage Community"})," too!"]}),"\n",(0,t.jsx)(n.h2,{id:"catalog",children:"Catalog"}),"\n",(0,t.jsx)(n.p,{children:"The Catalog collator will index all the Entities in your Catalog. It is installed by default but if you need to add it manually here's how."}),"\n",(0,t.jsx)(n.p,{children:"First we add the plugin into your backend app:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-search-backend-module-catalog\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then add the following line:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:'title="packages/backend/src/index.ts"',children:"const backend = createBackend();\n\n// Other plugins...\n\n// search plugin\nbackend.add(import('@backstage/plugin-search-backend'));\n\n/* highlight-add-start */\nbackend.add(import('@backstage/plugin-search-backend-module-catalog'));\n/* highlight-add-end */\n\nbackend.start();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"configuring-the-catalog-collator",children:"Configuring the Catalog Collator"}),"\n",(0,t.jsx)(n.p,{children:"The following sections outlines the available configurations for this collator."}),"\n",(0,t.jsx)(n.h4,{id:"scheduling",children:"Scheduling"}),"\n",(0,t.jsx)(n.p,{children:"The default schedule for the Catalog Collator is to run every 10 minutes, you can provide your own schedule by adding it to your config:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="app-config.yaml',children:'search:\n  collators:\n    catalog:\n      schedule: # same options as in SchedulerServiceTaskScheduleDefinition\n        # supports cron, ISO duration, "human duration" as used in code\n        initialDelay: { seconds: 90 }\n        # supports cron, ISO duration, "human duration" as used in code\n        frequency: { hours: 6 }\n        # supports ISO duration, "human duration" as used in code\n        timeout: { minutes: 3 }\n'})}),"\n",(0,t.jsx)(n.h4,{id:"filtering",children:"Filtering"}),"\n",(0,t.jsxs)(n.p,{children:["You may wish to collate specific subsets of entities in your Catalog, this can be accomplished using the ",(0,t.jsx)(n.code,{children:"filter"})," configuration option. Here's a basic example:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title"app-config.yaml"',children:"search:\n  collators:\n    catalog:\n      filter:\n        kind: ['component', 'api']\n        spec.lifecycle: production\n"})}),"\n",(0,t.jsxs)(n.p,{children:["The above example will only collate entities that are ",(0,t.jsx)(n.code,{children:"kind"})," equal to ",(0,t.jsx)(n.code,{children:"component"})," or ",(0,t.jsx)(n.code,{children:"api"})," AND have a ",(0,t.jsx)(n.code,{children:"spec.lifecycle"})," set to ",(0,t.jsx)(n.code,{children:"production"})]}),"\n",(0,t.jsx)(n.p,{children:"You can also apply a more advanced filter like this:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title"app-config.yaml"',children:"search:\n  collators:\n    catalog:\n      filter:\n        - kind: ['API']\n          spec.type: openapi\n        - kind: ['Component']\n          spec.lifecycle: experimental\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Now with this example it will collate all entities that are ",(0,t.jsx)(n.code,{children:"kind"})," equal to ",(0,t.jsx)(n.code,{children:"api"})," with a ",(0,t.jsx)(n.code,{children:"spec.type"})," equal to ",(0,t.jsx)(n.code,{children:"openapi"})," OR all entities that are ",(0,t.jsx)(n.code,{children:"kind"})," equal to ",(0,t.jsx)(n.code,{children:"component"})," AND have a ",(0,t.jsx)(n.code,{children:"spec.lifecycle"})," set to ",(0,t.jsx)(n.code,{children:"experimental"})]}),"\n",(0,t.jsx)(n.admonition,{type:"tip",children:(0,t.jsxs)(n.p,{children:["The filter configuration is implemented using the ",(0,t.jsx)(n.code,{children:"EntityFilterQuery"})," syntax. The ",(0,t.jsxs)(n.a,{href:"https://backstage.io/docs/reference/catalog-client.entityfilterquery/",children:["reference documentation on ",(0,t.jsx)(n.code,{children:"EntityFilterQuery"})]})," provides more details."]})}),"\n",(0,t.jsx)(n.h2,{id:"techdocs",children:"TechDocs"}),"\n",(0,t.jsx)(n.p,{children:"The TechDocs collator will index all the TechDocs in your Catalog. It is installed by default but if you need to add it manually here's how."}),"\n",(0,t.jsx)(n.p,{children:"First we add the plugin into your backend app:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",metastring:'title="From your Backstage root directory"',children:"yarn --cwd packages/backend add @backstage/plugin-search-backend-module-techdocs\n"})}),"\n",(0,t.jsx)(n.p,{children:"Then add the following line:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",metastring:'title="packages/backend/src/index.ts"',children:"const backend = createBackend();\n\n// Other plugins...\n\n// search plugin\nbackend.add(import('@backstage/plugin-search-backend'));\n\n/* highlight-add-start */\nbackend.add(import('@backstage/plugin-search-backend-module-techdocs'));\n/* highlight-add-end */\n\nbackend.start();\n"})}),"\n",(0,t.jsx)(n.h3,{id:"configuring-the-techdocs-collator",children:"Configuring the TechDocs Collator"}),"\n",(0,t.jsx)(n.p,{children:"The default schedule for the TechDocs Collator is to run every 10 minutes, you can provide your own schedule by adding it to your config:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",metastring:'title="app-config.yaml',children:'search:\n  collators:\n    techdocs:\n      schedule: # same options as in SchedulerServiceTaskScheduleDefinition\n        # supports cron, ISO duration, "human duration" as used in code\n        initialDelay: { seconds: 90 }\n        # supports cron, ISO duration, "human duration" as used in code\n        frequency: { hours: 6 }\n        # supports ISO duration, "human duration" as used in code\n        timeout: { minutes: 3 }\n'})}),"\n",(0,t.jsx)(n.h2,{id:"community-collators",children:"Community Collators"}),"\n",(0,t.jsx)(n.p,{children:"Here are some of the known Search Collators available in from the Backstage Community:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/search-backend-module-explore",children:(0,t.jsx)(n.code,{children:"@backstage/plugin-search-backend-module-explore"})}),": will index content from the ",(0,t.jsx)(n.a,{href:"https://github.com/backstage/community-plugins/tree/main/workspaces/explore/plugins/explore",children:"Explore plugin"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/backstage/backstage/tree/master/plugins/search-backend-module-stack-overflow-collator",children:(0,t.jsx)(n.code,{children:"@backstage/plugin-search-backend-module-stack-overflow-collator"})}),": will index content from Stack Overflow."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"https://github.com/backstage/community-plugins/tree/main/workspaces/adr/plugins/search-backend-module-adr",children:(0,t.jsx)(n.code,{children:"@backstage-community/search-backend-module-adr"})}),": will index content from the ",(0,t.jsx)(n.a,{href:"https://github.com/backstage/community-plugins/tree/main/workspaces/adr/plugins/adr",children:"ADR plugin"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"custom-collators",children:"Custom Collators"}),"\n",(0,t.jsxs)(n.p,{children:["To create your own collators/decorators modules, please use the ",(0,t.jsx)(n.a,{href:"https://github.com/backstage/backstage/blob/d7f955f300893f50c4882ea8f5c09aa42dfaacfd/plugins/search-backend-module-catalog/src/alpha.ts#L49",children:"searchModuleCatalogCollator"})," as an example, we recommend that modules are separated by plugin packages (e.g. ",(0,t.jsx)(n.code,{children:"search-backend-module-<plugin-id>"}),"). You can also find the available search engines and collator/decorator modules documentation in the Alpha API reports."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},221020:(e,n,a)=>{var t=a(296540),o=Symbol.for("react.element"),c=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function r(e,n,a){var t,c={},r=null,d=null;for(t in void 0!==a&&(r=""+a),void 0!==n.key&&(r=""+n.key),void 0!==n.ref&&(d=n.ref),n)l.call(n,t)&&!i.hasOwnProperty(t)&&(c[t]=n[t]);if(e&&e.defaultProps)for(t in n=e.defaultProps)void 0===c[t]&&(c[t]=n[t]);return{$$typeof:o,type:e,key:r,ref:d,props:c,_owner:s.current}}n.Fragment=c,n.jsx=r,n.jsxs=r},474848:(e,n,a)=>{e.exports=a(221020)},28453:(e,n,a)=>{a.d(n,{R:()=>l,x:()=>s});var t=a(296540);const o={},c=t.createContext(o);function l(e){const n=t.useContext(c);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),t.createElement(c.Provider,{value:n},e.children)}}}]);